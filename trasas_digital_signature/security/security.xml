<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!--
        TRASAS Digital Signature Security
        ==================================
        Reuses contract management security groups:
        - group_contract_user: tạo/quản lý yêu cầu ký
        - group_contract_approver: xem yêu cầu ký
        - group_contract_manager: full access + cấu hình provider
    -->

    <!-- Record Rules: Signature Request -->

    <!-- User: đọc/sửa/tạo yêu cầu ký của mình -->
    <record id="signature_request_user_own_rule" model="ir.rule">
        <field name="name">Signature Request: User Own</field>
        <field name="model_id" ref="model_trasas_signature_request"/>
        <field name="domain_force">[('user_id', '=', user.id)]</field>
        <field name="groups" eval="[(4, ref('trasas_contract_management.group_contract_user'))]"/>
        <field name="perm_read" eval="False"/>
        <field name="perm_write" eval="True"/>
        <field name="perm_create" eval="True"/>
        <field name="perm_unlink" eval="True"/>
    </record>

    <!-- User: đọc tất cả yêu cầu ký -->
    <record id="signature_request_user_read_all_rule" model="ir.rule">
        <field name="name">Signature Request: User Read All</field>
        <field name="model_id" ref="model_trasas_signature_request"/>
        <field name="domain_force">[(1, '=', 1)]</field>
        <field name="groups" eval="[(4, ref('trasas_contract_management.group_contract_user'))]"/>
        <field name="perm_read" eval="True"/>
        <field name="perm_write" eval="False"/>
        <field name="perm_create" eval="False"/>
        <field name="perm_unlink" eval="False"/>
    </record>

    <!-- Approver: đọc/sửa tất cả -->
    <record id="signature_request_approver_rule" model="ir.rule">
        <field name="name">Signature Request: Approver All</field>
        <field name="model_id" ref="model_trasas_signature_request"/>
        <field name="domain_force">[(1, '=', 1)]</field>
        <field name="groups" eval="[(4, ref('trasas_contract_management.group_contract_approver'))]"/>
        <field name="perm_read" eval="True"/>
        <field name="perm_write" eval="True"/>
        <field name="perm_create" eval="False"/>
        <field name="perm_unlink" eval="False"/>
    </record>

    <!-- Manager: full access -->
    <record id="signature_request_manager_rule" model="ir.rule">
        <field name="name">Signature Request: Manager Full</field>
        <field name="model_id" ref="model_trasas_signature_request"/>
        <field name="domain_force">[(1, '=', 1)]</field>
        <field name="groups" eval="[(4, ref('trasas_contract_management.group_contract_manager'))]"/>
        <field name="perm_read" eval="True"/>
        <field name="perm_write" eval="True"/>
        <field name="perm_create" eval="True"/>
        <field name="perm_unlink" eval="True"/>
    </record>
</odoo>
